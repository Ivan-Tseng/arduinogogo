<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ESP32 Motor Control</title>
</head>
<body>
    <h1>ESP32 Motor Control</h1>
    <button id="forwardButton">Move Forward</button>
    <button id="backwardButton">Move Backward</button>
    <button id="stopButton">Stop Motor</button>

    <script>
        let forwardButton = document.getElementById('forwardButton');
        let backwardButton = document.getElementById('backwardButton');
        let stopButton = document.getElementById('stopButton');

        // 连接到 ESP32 BLE 设备
        async function connectBluetooth() {
            const device = await navigator.bluetooth.requestDevice({
                filters: [{ services: ['4fafc201-1fb5-459e-8fcc-c5c9c331914b'] }]
            });

            const server = await device.gatt.connect();
            const service = await server.getPrimaryService('4fafc201-1fb5-459e-8fcc-c5c9c331914b');
            return { service, server };
        }

        // 发送控制指令
        async function sendCommand(command) {
            const { service, server } = await connectBluetooth();
            const characteristic = await service.getCharacteristic('c0de1234-5678-9101-1121-314151617181');
            await characteristic.writeValue(new TextEncoder().encode(command));
            console.log("Command sent:", command);
        }

        // 按钮点击事件
        forwardButton.addEventListener('click', async () => {
            await sendCommand('forward');
        });

        backwardButton.addEventListener('click', async () => {
            await sendCommand('backward');
        });

        stopButton.addEventListener('click', async () => {
            await sendCommand('stop');
        });
    </script>
</body>
</html>
